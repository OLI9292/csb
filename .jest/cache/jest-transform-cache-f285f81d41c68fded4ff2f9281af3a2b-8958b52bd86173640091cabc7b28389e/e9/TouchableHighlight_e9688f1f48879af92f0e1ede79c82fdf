6d166ca6534afd17ba6a36c45828818f

'use strict';

var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };

var ColorPropType = require('ColorPropType');
var NativeMethodsMixin = require('NativeMethodsMixin');
var PropTypes = require('prop-types');
var Platform = require('Platform');
var React = require('React');
var ReactNativeViewAttributes = require('ReactNativeViewAttributes');
var StyleSheet = require('StyleSheet');
var Touchable = require('Touchable');
var TouchableWithoutFeedback = require('TouchableWithoutFeedback');
var View = require('View');
var ViewPropTypes = require('ViewPropTypes');

var createReactClass = require('create-react-class');
var ensurePositiveDelayProps = require('ensurePositiveDelayProps');

var DEFAULT_PROPS = {
  activeOpacity: 0.85,
  delayPressOut: 100,
  underlayColor: 'black'
};

var PRESS_RETENTION_OFFSET = { top: 20, left: 20, right: 20, bottom: 30 };

var TouchableHighlight = createReactClass({
  displayName: 'TouchableHighlight',
  propTypes: _extends({}, TouchableWithoutFeedback.propTypes, {
    activeOpacity: PropTypes.number,

    underlayColor: ColorPropType,

    style: ViewPropTypes.style,

    onShowUnderlay: PropTypes.func,

    onHideUnderlay: PropTypes.func,

    hasTVPreferredFocus: PropTypes.bool,

    tvParallaxProperties: PropTypes.object,

    testOnly_pressed: PropTypes.bool
  }),

  mixins: [NativeMethodsMixin, Touchable.Mixin],

  getDefaultProps: function getDefaultProps() {
    return DEFAULT_PROPS;
  },

  getInitialState: function getInitialState() {
    this._isMounted = false;
    if (this.props.testOnly_pressed) {
      return _extends({}, this.touchableGetInitialState(), {
        extraChildStyle: {
          opacity: this.props.activeOpacity
        },
        extraUnderlayStyle: {
          backgroundColor: this.props.underlayColor
        }
      });
    } else {
      return _extends({}, this.touchableGetInitialState(), {
        extraChildStyle: null,
        extraUnderlayStyle: null
      });
    }
  },

  componentDidMount: function componentDidMount() {
    this._isMounted = true;
    ensurePositiveDelayProps(this.props);
  },

  componentWillUnmount: function componentWillUnmount() {
    this._isMounted = false;
    clearTimeout(this._hideTimeout);
  },

  UNSAFE_componentWillReceiveProps: function UNSAFE_componentWillReceiveProps(nextProps) {
    ensurePositiveDelayProps(nextProps);
  },

  viewConfig: {
    uiViewClassName: 'RCTView',
    validAttributes: ReactNativeViewAttributes.RCTView
  },

  touchableHandleActivePressIn: function touchableHandleActivePressIn(e) {
    clearTimeout(this._hideTimeout);
    this._hideTimeout = null;
    this._showUnderlay();
    this.props.onPressIn && this.props.onPressIn(e);
  },

  touchableHandleActivePressOut: function touchableHandleActivePressOut(e) {
    if (!this._hideTimeout) {
      this._hideUnderlay();
    }
    this.props.onPressOut && this.props.onPressOut(e);
  },

  touchableHandlePress: function touchableHandlePress(e) {
    clearTimeout(this._hideTimeout);
    if (!Platform.isTVOS) {
      this._showUnderlay();
      this._hideTimeout = setTimeout(this._hideUnderlay, this.props.delayPressOut);
    }
    this.props.onPress && this.props.onPress(e);
  },

  touchableHandleLongPress: function touchableHandleLongPress(e) {
    this.props.onLongPress && this.props.onLongPress(e);
  },

  touchableGetPressRectOffset: function touchableGetPressRectOffset() {
    return this.props.pressRetentionOffset || PRESS_RETENTION_OFFSET;
  },

  touchableGetHitSlop: function touchableGetHitSlop() {
    return this.props.hitSlop;
  },

  touchableGetHighlightDelayMS: function touchableGetHighlightDelayMS() {
    return this.props.delayPressIn;
  },

  touchableGetLongPressDelayMS: function touchableGetLongPressDelayMS() {
    return this.props.delayLongPress;
  },

  touchableGetPressOutDelayMS: function touchableGetPressOutDelayMS() {
    return this.props.delayPressOut;
  },

  _showUnderlay: function _showUnderlay() {
    if (!this._isMounted || !this._hasPressHandler()) {
      return;
    }
    this.setState({
      extraChildStyle: {
        opacity: this.props.activeOpacity
      },
      extraUnderlayStyle: {
        backgroundColor: this.props.underlayColor
      }
    });
    this.props.onShowUnderlay && this.props.onShowUnderlay();
  },

  _hideUnderlay: function _hideUnderlay() {
    clearTimeout(this._hideTimeout);
    this._hideTimeout = null;
    if (this.props.testOnly_pressed) {
      return;
    }
    if (this._hasPressHandler()) {
      this.setState({
        extraChildStyle: null,
        extraUnderlayStyle: null
      });
      this.props.onHideUnderlay && this.props.onHideUnderlay();
    }
  },

  _hasPressHandler: function _hasPressHandler() {
    return !!(this.props.onPress || this.props.onPressIn || this.props.onPressOut || this.props.onLongPress);
  },

  render: function render() {
    var child = React.Children.only(this.props.children);
    return React.createElement(
      View,
      {
        accessible: this.props.accessible !== false,
        accessibilityLabel: this.props.accessibilityLabel,
        accessibilityComponentType: this.props.accessibilityComponentType,
        accessibilityTraits: this.props.accessibilityTraits,
        style: StyleSheet.compose(this.props.style, this.state.extraUnderlayStyle),
        onLayout: this.props.onLayout,
        hitSlop: this.props.hitSlop,
        isTVSelectable: true,
        tvParallaxProperties: this.props.tvParallaxProperties,
        hasTVPreferredFocus: this.props.hasTVPreferredFocus,
        onStartShouldSetResponder: this.touchableHandleStartShouldSetResponder,
        onResponderTerminationRequest: this.touchableHandleResponderTerminationRequest,
        onResponderGrant: this.touchableHandleResponderGrant,
        onResponderMove: this.touchableHandleResponderMove,
        onResponderRelease: this.touchableHandleResponderRelease,
        onResponderTerminate: this.touchableHandleResponderTerminate,
        nativeID: this.props.nativeID,
        testID: this.props.testID },
      React.cloneElement(child, {
        style: StyleSheet.compose(child.props.style, this.state.extraChildStyle)
      }),
      Touchable.renderDebugView({
        color: 'green',
        hitSlop: this.props.hitSlop
      })
    );
  }
});

module.exports = TouchableHighlight;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlRvdWNoYWJsZUhpZ2hsaWdodC5qcyJdLCJuYW1lcyI6WyJDb2xvclByb3BUeXBlIiwicmVxdWlyZSIsIk5hdGl2ZU1ldGhvZHNNaXhpbiIsIlByb3BUeXBlcyIsIlBsYXRmb3JtIiwiUmVhY3QiLCJSZWFjdE5hdGl2ZVZpZXdBdHRyaWJ1dGVzIiwiU3R5bGVTaGVldCIsIlRvdWNoYWJsZSIsIlRvdWNoYWJsZVdpdGhvdXRGZWVkYmFjayIsIlZpZXciLCJWaWV3UHJvcFR5cGVzIiwiY3JlYXRlUmVhY3RDbGFzcyIsImVuc3VyZVBvc2l0aXZlRGVsYXlQcm9wcyIsIkRFRkFVTFRfUFJPUFMiLCJhY3RpdmVPcGFjaXR5IiwiZGVsYXlQcmVzc091dCIsInVuZGVybGF5Q29sb3IiLCJQUkVTU19SRVRFTlRJT05fT0ZGU0VUIiwidG9wIiwibGVmdCIsInJpZ2h0IiwiYm90dG9tIiwiVG91Y2hhYmxlSGlnaGxpZ2h0IiwiZGlzcGxheU5hbWUiLCJwcm9wVHlwZXMiLCJudW1iZXIiLCJzdHlsZSIsIm9uU2hvd1VuZGVybGF5IiwiZnVuYyIsIm9uSGlkZVVuZGVybGF5IiwiaGFzVFZQcmVmZXJyZWRGb2N1cyIsImJvb2wiLCJ0dlBhcmFsbGF4UHJvcGVydGllcyIsIm9iamVjdCIsInRlc3RPbmx5X3ByZXNzZWQiLCJtaXhpbnMiLCJNaXhpbiIsImdldERlZmF1bHRQcm9wcyIsImdldEluaXRpYWxTdGF0ZSIsIl9pc01vdW50ZWQiLCJwcm9wcyIsInRvdWNoYWJsZUdldEluaXRpYWxTdGF0ZSIsImV4dHJhQ2hpbGRTdHlsZSIsIm9wYWNpdHkiLCJleHRyYVVuZGVybGF5U3R5bGUiLCJiYWNrZ3JvdW5kQ29sb3IiLCJjb21wb25lbnREaWRNb3VudCIsImNvbXBvbmVudFdpbGxVbm1vdW50IiwiY2xlYXJUaW1lb3V0IiwiX2hpZGVUaW1lb3V0IiwiVU5TQUZFX2NvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMiLCJuZXh0UHJvcHMiLCJ2aWV3Q29uZmlnIiwidWlWaWV3Q2xhc3NOYW1lIiwidmFsaWRBdHRyaWJ1dGVzIiwiUkNUVmlldyIsInRvdWNoYWJsZUhhbmRsZUFjdGl2ZVByZXNzSW4iLCJlIiwiX3Nob3dVbmRlcmxheSIsIm9uUHJlc3NJbiIsInRvdWNoYWJsZUhhbmRsZUFjdGl2ZVByZXNzT3V0IiwiX2hpZGVVbmRlcmxheSIsIm9uUHJlc3NPdXQiLCJ0b3VjaGFibGVIYW5kbGVQcmVzcyIsImlzVFZPUyIsInNldFRpbWVvdXQiLCJvblByZXNzIiwidG91Y2hhYmxlSGFuZGxlTG9uZ1ByZXNzIiwib25Mb25nUHJlc3MiLCJ0b3VjaGFibGVHZXRQcmVzc1JlY3RPZmZzZXQiLCJwcmVzc1JldGVudGlvbk9mZnNldCIsInRvdWNoYWJsZUdldEhpdFNsb3AiLCJoaXRTbG9wIiwidG91Y2hhYmxlR2V0SGlnaGxpZ2h0RGVsYXlNUyIsImRlbGF5UHJlc3NJbiIsInRvdWNoYWJsZUdldExvbmdQcmVzc0RlbGF5TVMiLCJkZWxheUxvbmdQcmVzcyIsInRvdWNoYWJsZUdldFByZXNzT3V0RGVsYXlNUyIsIl9oYXNQcmVzc0hhbmRsZXIiLCJzZXRTdGF0ZSIsInJlbmRlciIsImNoaWxkIiwiQ2hpbGRyZW4iLCJvbmx5IiwiY2hpbGRyZW4iLCJhY2Nlc3NpYmxlIiwiYWNjZXNzaWJpbGl0eUxhYmVsIiwiYWNjZXNzaWJpbGl0eUNvbXBvbmVudFR5cGUiLCJhY2Nlc3NpYmlsaXR5VHJhaXRzIiwiY29tcG9zZSIsInN0YXRlIiwib25MYXlvdXQiLCJ0b3VjaGFibGVIYW5kbGVTdGFydFNob3VsZFNldFJlc3BvbmRlciIsInRvdWNoYWJsZUhhbmRsZVJlc3BvbmRlclRlcm1pbmF0aW9uUmVxdWVzdCIsInRvdWNoYWJsZUhhbmRsZVJlc3BvbmRlckdyYW50IiwidG91Y2hhYmxlSGFuZGxlUmVzcG9uZGVyTW92ZSIsInRvdWNoYWJsZUhhbmRsZVJlc3BvbmRlclJlbGVhc2UiLCJ0b3VjaGFibGVIYW5kbGVSZXNwb25kZXJUZXJtaW5hdGUiLCJuYXRpdmVJRCIsInRlc3RJRCIsImNsb25l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cEIsV0FBV21GLE9BQVgsQ0FDTFIsTUFBTXpDLEtBQU4sQ0FBWWQsS0FEUCxFQUVMLEtBQUtnRSxLQUFMLENBQVdoRCxlQUZOO0FBRGtCLE9BQTFCLENBeEJIO0FBOEJHbkMsZ0JBQVU4RixlQUFWLENBQTBCO0FBQ3pCQyxlQUFPLE9BRGtCO0FBRXpCOUIsaUJBQVMsS0FBS2hDLEtBQUwsQ0FBV2dDO0FBRkssT0FBMUI7QUE5QkgsS0FERjtBQXFDRDtBQXRPeUMsQ0FBakIsQ0FBM0I7O0FBeU9BK0IsT0FBT0MsT0FBUCxHQUFpQmxGLGtCQUFqQiIsImZpbGUiOiJUb3VjaGFibGVIaWdobGlnaHQuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNS1wcmVzZW50LCBGYWNlYm9vaywgSW5jLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlIGZvdW5kIGluIHRoZVxuICogTElDRU5TRSBmaWxlIGluIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICpcbiAqIEBwcm92aWRlc01vZHVsZSBUb3VjaGFibGVIaWdobGlnaHRcbiAqIEBmbG93XG4gKiBAZm9ybWF0XG4gKi9cbid1c2Ugc3RyaWN0JztcblxuY29uc3QgQ29sb3JQcm9wVHlwZSA9IHJlcXVpcmUoJ0NvbG9yUHJvcFR5cGUnKTtcbmNvbnN0IE5hdGl2ZU1ldGhvZHNNaXhpbiA9IHJlcXVpcmUoJ05hdGl2ZU1ldGhvZHNNaXhpbicpO1xuY29uc3QgUHJvcFR5cGVzID0gcmVxdWlyZSgncHJvcC10eXBlcycpO1xuY29uc3QgUGxhdGZvcm0gPSByZXF1aXJlKCdQbGF0Zm9ybScpO1xuY29uc3QgUmVhY3QgPSByZXF1aXJlKCdSZWFjdCcpO1xuY29uc3QgUmVhY3ROYXRpdmVWaWV3QXR0cmlidXRlcyA9IHJlcXVpcmUoJ1JlYWN0TmF0aXZlVmlld0F0dHJpYnV0ZXMnKTtcbmNvbnN0IFN0eWxlU2hlZXQgPSByZXF1aXJlKCdTdHlsZVNoZWV0Jyk7XG5jb25zdCBUb3VjaGFibGUgPSByZXF1aXJlKCdUb3VjaGFibGUnKTtcbmNvbnN0IFRvdWNoYWJsZVdpdGhvdXRGZWVkYmFjayA9IHJlcXVpcmUoJ1RvdWNoYWJsZVdpdGhvdXRGZWVkYmFjaycpO1xuY29uc3QgVmlldyA9IHJlcXVpcmUoJ1ZpZXcnKTtcbmNvbnN0IFZpZXdQcm9wVHlwZXMgPSByZXF1aXJlKCdWaWV3UHJvcFR5cGVzJyk7XG5cbmNvbnN0IGNyZWF0ZVJlYWN0Q2xhc3MgPSByZXF1aXJlKCdjcmVhdGUtcmVhY3QtY2xhc3MnKTtcbmNvbnN0IGVuc3VyZVBvc2l0aXZlRGVsYXlQcm9wcyA9IHJlcXVpcmUoJ2Vuc3VyZVBvc2l0aXZlRGVsYXlQcm9wcycpO1xuXG5pbXBvcnQgdHlwZSB7UHJlc3NFdmVudH0gZnJvbSAnQ29yZUV2ZW50VHlwZXMnO1xuXG5jb25zdCBERUZBVUxUX1BST1BTID0ge1xuICBhY3RpdmVPcGFjaXR5OiAwLjg1LFxuICBkZWxheVByZXNzT3V0OiAxMDAsXG4gIHVuZGVybGF5Q29sb3I6ICdibGFjaycsXG59O1xuXG5jb25zdCBQUkVTU19SRVRFTlRJT05fT0ZGU0VUID0ge3RvcDogMjAsIGxlZnQ6IDIwLCByaWdodDogMjAsIGJvdHRvbTogMzB9O1xuXG4vKipcbiAqIEEgd3JhcHBlciBmb3IgbWFraW5nIHZpZXdzIHJlc3BvbmQgcHJvcGVybHkgdG8gdG91Y2hlcy5cbiAqIE9uIHByZXNzIGRvd24sIHRoZSBvcGFjaXR5IG9mIHRoZSB3cmFwcGVkIHZpZXcgaXMgZGVjcmVhc2VkLCB3aGljaCBhbGxvd3NcbiAqIHRoZSB1bmRlcmxheSBjb2xvciB0byBzaG93IHRocm91Z2gsIGRhcmtlbmluZyBvciB0aW50aW5nIHRoZSB2aWV3LlxuICpcbiAqIFRoZSB1bmRlcmxheSBjb21lcyBmcm9tIHdyYXBwaW5nIHRoZSBjaGlsZCBpbiBhIG5ldyBWaWV3LCB3aGljaCBjYW4gYWZmZWN0XG4gKiBsYXlvdXQsIGFuZCBzb21ldGltZXMgY2F1c2UgdW53YW50ZWQgdmlzdWFsIGFydGlmYWN0cyBpZiBub3QgdXNlZCBjb3JyZWN0bHksXG4gKiBmb3IgZXhhbXBsZSBpZiB0aGUgYmFja2dyb3VuZENvbG9yIG9mIHRoZSB3cmFwcGVkIHZpZXcgaXNuJ3QgZXhwbGljaXRseSBzZXRcbiAqIHRvIGFuIG9wYXF1ZSBjb2xvci5cbiAqXG4gKiBUb3VjaGFibGVIaWdobGlnaHQgbXVzdCBoYXZlIG9uZSBjaGlsZCAobm90IHplcm8gb3IgbW9yZSB0aGFuIG9uZSkuXG4gKiBJZiB5b3Ugd2lzaCB0byBoYXZlIHNldmVyYWwgY2hpbGQgY29tcG9uZW50cywgd3JhcCB0aGVtIGluIGEgVmlldy5cbiAqXG4gKiBFeGFtcGxlOlxuICpcbiAqIGBgYFxuICogcmVuZGVyQnV0dG9uOiBmdW5jdGlvbigpIHtcbiAqICAgcmV0dXJuIChcbiAqICAgICA8VG91Y2hhYmxlSGlnaGxpZ2h0IG9uUHJlc3M9e3RoaXMuX29uUHJlc3NCdXR0b259PlxuICogICAgICAgPEltYWdlXG4gKiAgICAgICAgIHN0eWxlPXtzdHlsZXMuYnV0dG9ufVxuICogICAgICAgICBzb3VyY2U9e3JlcXVpcmUoJy4vbXlCdXR0b24ucG5nJyl9XG4gKiAgICAgICAvPlxuICogICAgIDwvVG91Y2hhYmxlSGlnaGxpZ2h0PlxuICogICApO1xuICogfSxcbiAqIGBgYFxuICpcbiAqXG4gKiAjIyMgRXhhbXBsZVxuICpcbiAqIGBgYFJlYWN0TmF0aXZlV2ViUGxheWVyXG4gKiBpbXBvcnQgUmVhY3QsIHsgQ29tcG9uZW50IH0gZnJvbSAncmVhY3QnXG4gKiBpbXBvcnQge1xuICogICBBcHBSZWdpc3RyeSxcbiAqICAgU3R5bGVTaGVldCxcbiAqICAgVG91Y2hhYmxlSGlnaGxpZ2h0LFxuICogICBUZXh0LFxuICogICBWaWV3LFxuICogfSBmcm9tICdyZWFjdC1uYXRpdmUnXG4gKlxuICogY2xhc3MgQXBwIGV4dGVuZHMgQ29tcG9uZW50IHtcbiAqICAgY29uc3RydWN0b3IocHJvcHMpIHtcbiAqICAgICBzdXBlcihwcm9wcylcbiAqICAgICB0aGlzLnN0YXRlID0geyBjb3VudDogMCB9XG4gKiAgIH1cbiAqXG4gKiAgIG9uUHJlc3MgPSAoKSA9PiB7XG4gKiAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gKiAgICAgICBjb3VudDogdGhpcy5zdGF0ZS5jb3VudCsxXG4gKiAgICAgfSlcbiAqICAgfVxuICpcbiAqICByZW5kZXIoKSB7XG4gKiAgICAgcmV0dXJuIChcbiAqICAgICAgIDxWaWV3IHN0eWxlPXtzdHlsZXMuY29udGFpbmVyfT5cbiAqICAgICAgICAgPFRvdWNoYWJsZUhpZ2hsaWdodFxuICogICAgICAgICAgc3R5bGU9e3N0eWxlcy5idXR0b259XG4gKiAgICAgICAgICBvblByZXNzPXt0aGlzLm9uUHJlc3N9XG4gKiAgICAgICAgID5cbiAqICAgICAgICAgIDxUZXh0PiBUb3VjaCBIZXJlIDwvVGV4dD5cbiAqICAgICAgICAgPC9Ub3VjaGFibGVIaWdobGlnaHQ+XG4gKiAgICAgICAgIDxWaWV3IHN0eWxlPXtbc3R5bGVzLmNvdW50Q29udGFpbmVyXX0+XG4gKiAgICAgICAgICAgPFRleHQgc3R5bGU9e1tzdHlsZXMuY291bnRUZXh0XX0+XG4gKiAgICAgICAgICAgICB7IHRoaXMuc3RhdGUuY291bnQgIT09IDAgPyB0aGlzLnN0YXRlLmNvdW50OiBudWxsfVxuICogICAgICAgICAgIDwvVGV4dD5cbiAqICAgICAgICAgPC9WaWV3PlxuICogICAgICAgPC9WaWV3PlxuICogICAgIClcbiAqICAgfVxuICogfVxuICpcbiAqIGNvbnN0IHN0eWxlcyA9IFN0eWxlU2hlZXQuY3JlYXRlKHtcbiAqICAgY29udGFpbmVyOiB7XG4gKiAgICAgZmxleDogMSxcbiAqICAgICBqdXN0aWZ5Q29udGVudDogJ2NlbnRlcicsXG4gKiAgICAgcGFkZGluZ0hvcml6b250YWw6IDEwXG4gKiAgIH0sXG4gKiAgIGJ1dHRvbjoge1xuICogICAgIGFsaWduSXRlbXM6ICdjZW50ZXInLFxuICogICAgIGJhY2tncm91bmRDb2xvcjogJyNEREREREQnLFxuICogICAgIHBhZGRpbmc6IDEwXG4gKiAgIH0sXG4gKiAgIGNvdW50Q29udGFpbmVyOiB7XG4gKiAgICAgYWxpZ25JdGVtczogJ2NlbnRlcicsXG4gKiAgICAgcGFkZGluZzogMTBcbiAqICAgfSxcbiAqICAgY291bnRUZXh0OiB7XG4gKiAgICAgY29sb3I6ICcjRkYwMEZGJ1xuICogICB9XG4gKiB9KVxuICpcbiAqIEFwcFJlZ2lzdHJ5LnJlZ2lzdGVyQ29tcG9uZW50KCdBcHAnLCAoKSA9PiBBcHApXG4gKiBgYGBcbiAqXG4gKi9cblxuY29uc3QgVG91Y2hhYmxlSGlnaGxpZ2h0ID0gY3JlYXRlUmVhY3RDbGFzcyh7XG4gIGRpc3BsYXlOYW1lOiAnVG91Y2hhYmxlSGlnaGxpZ2h0JyxcbiAgcHJvcFR5cGVzOiB7XG4gICAgLi4uVG91Y2hhYmxlV2l0aG91dEZlZWRiYWNrLnByb3BUeXBlcyxcbiAgICAvKipcbiAgICAgKiBEZXRlcm1pbmVzIHdoYXQgdGhlIG9wYWNpdHkgb2YgdGhlIHdyYXBwZWQgdmlldyBzaG91bGQgYmUgd2hlbiB0b3VjaCBpc1xuICAgICAqIGFjdGl2ZS5cbiAgICAgKi9cbiAgICBhY3RpdmVPcGFjaXR5OiBQcm9wVHlwZXMubnVtYmVyLFxuICAgIC8qKlxuICAgICAqIFRoZSBjb2xvciBvZiB0aGUgdW5kZXJsYXkgdGhhdCB3aWxsIHNob3cgdGhyb3VnaCB3aGVuIHRoZSB0b3VjaCBpc1xuICAgICAqIGFjdGl2ZS5cbiAgICAgKi9cbiAgICB1bmRlcmxheUNvbG9yOiBDb2xvclByb3BUeXBlLFxuICAgIC8qKlxuICAgICAqIFN0eWxlIHRvIGFwcGx5IHRvIHRoZSBjb250YWluZXIvdW5kZXJsYXkuIE1vc3QgY29tbW9ubHkgdXNlZCB0byBtYWtlIHN1cmVcbiAgICAgKiByb3VuZGVkIGNvcm5lcnMgbWF0Y2ggdGhlIHdyYXBwZWQgY29tcG9uZW50LlxuICAgICAqL1xuICAgIHN0eWxlOiBWaWV3UHJvcFR5cGVzLnN0eWxlLFxuICAgIC8qKlxuICAgICAqIENhbGxlZCBpbW1lZGlhdGVseSBhZnRlciB0aGUgdW5kZXJsYXkgaXMgc2hvd25cbiAgICAgKi9cbiAgICBvblNob3dVbmRlcmxheTogUHJvcFR5cGVzLmZ1bmMsXG4gICAgLyoqXG4gICAgICogQ2FsbGVkIGltbWVkaWF0ZWx5IGFmdGVyIHRoZSB1bmRlcmxheSBpcyBoaWRkZW5cbiAgICAgKi9cbiAgICBvbkhpZGVVbmRlcmxheTogUHJvcFR5cGVzLmZ1bmMsXG4gICAgLyoqXG4gICAgICogKihBcHBsZSBUViBvbmx5KSogVFYgcHJlZmVycmVkIGZvY3VzIChzZWUgZG9jdW1lbnRhdGlvbiBmb3IgdGhlIFZpZXcgY29tcG9uZW50KS5cbiAgICAgKlxuICAgICAqIEBwbGF0Zm9ybSBpb3NcbiAgICAgKi9cbiAgICBoYXNUVlByZWZlcnJlZEZvY3VzOiBQcm9wVHlwZXMuYm9vbCxcbiAgICAvKipcbiAgICAgKiAqKEFwcGxlIFRWIG9ubHkpKiBPYmplY3Qgd2l0aCBwcm9wZXJ0aWVzIHRvIGNvbnRyb2wgQXBwbGUgVFYgcGFyYWxsYXggZWZmZWN0cy5cbiAgICAgKlxuICAgICAqIGVuYWJsZWQ6IElmIHRydWUsIHBhcmFsbGF4IGVmZmVjdHMgYXJlIGVuYWJsZWQuICBEZWZhdWx0cyB0byB0cnVlLlxuICAgICAqIHNoaWZ0RGlzdGFuY2VYOiBEZWZhdWx0cyB0byAyLjAuXG4gICAgICogc2hpZnREaXN0YW5jZVk6IERlZmF1bHRzIHRvIDIuMC5cbiAgICAgKiB0aWx0QW5nbGU6IERlZmF1bHRzIHRvIDAuMDUuXG4gICAgICogbWFnbmlmaWNhdGlvbjogRGVmYXVsdHMgdG8gMS4wLlxuICAgICAqIHByZXNzTWFnbmlmaWNhdGlvbjogRGVmYXVsdHMgdG8gMS4wLlxuICAgICAqIHByZXNzRHVyYXRpb246IERlZmF1bHRzIHRvIDAuMy5cbiAgICAgKiBwcmVzc0RlbGF5OiBEZWZhdWx0cyB0byAwLjAuXG4gICAgICpcbiAgICAgKiBAcGxhdGZvcm0gaW9zXG4gICAgICovXG4gICAgdHZQYXJhbGxheFByb3BlcnRpZXM6IFByb3BUeXBlcy5vYmplY3QsXG4gICAgLyoqXG4gICAgICogSGFuZHkgZm9yIHNuYXBzaG90IHRlc3RzLlxuICAgICAqL1xuICAgIHRlc3RPbmx5X3ByZXNzZWQ6IFByb3BUeXBlcy5ib29sLFxuICB9LFxuXG4gIG1peGluczogW05hdGl2ZU1ldGhvZHNNaXhpbiwgVG91Y2hhYmxlLk1peGluXSxcblxuICBnZXREZWZhdWx0UHJvcHM6ICgpID0+IERFRkFVTFRfUFJPUFMsXG5cbiAgZ2V0SW5pdGlhbFN0YXRlOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLl9pc01vdW50ZWQgPSBmYWxzZTtcbiAgICBpZiAodGhpcy5wcm9wcy50ZXN0T25seV9wcmVzc2VkKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICAuLi50aGlzLnRvdWNoYWJsZUdldEluaXRpYWxTdGF0ZSgpLFxuICAgICAgICBleHRyYUNoaWxkU3R5bGU6IHtcbiAgICAgICAgICBvcGFjaXR5OiB0aGlzLnByb3BzLmFjdGl2ZU9wYWNpdHksXG4gICAgICAgIH0sXG4gICAgICAgIGV4dHJhVW5kZXJsYXlTdHlsZToge1xuICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogdGhpcy5wcm9wcy51bmRlcmxheUNvbG9yLFxuICAgICAgICB9LFxuICAgICAgfTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4udGhpcy50b3VjaGFibGVHZXRJbml0aWFsU3RhdGUoKSxcbiAgICAgICAgZXh0cmFDaGlsZFN0eWxlOiBudWxsLFxuICAgICAgICBleHRyYVVuZGVybGF5U3R5bGU6IG51bGwsXG4gICAgICB9O1xuICAgIH1cbiAgfSxcblxuICBjb21wb25lbnREaWRNb3VudDogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5faXNNb3VudGVkID0gdHJ1ZTtcbiAgICBlbnN1cmVQb3NpdGl2ZURlbGF5UHJvcHModGhpcy5wcm9wcyk7XG4gIH0sXG5cbiAgY29tcG9uZW50V2lsbFVubW91bnQ6IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuX2lzTW91bnRlZCA9IGZhbHNlO1xuICAgIGNsZWFyVGltZW91dCh0aGlzLl9oaWRlVGltZW91dCk7XG4gIH0sXG5cbiAgVU5TQUZFX2NvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHM6IGZ1bmN0aW9uKG5leHRQcm9wcykge1xuICAgIGVuc3VyZVBvc2l0aXZlRGVsYXlQcm9wcyhuZXh0UHJvcHMpO1xuICB9LFxuXG4gIHZpZXdDb25maWc6IHtcbiAgICB1aVZpZXdDbGFzc05hbWU6ICdSQ1RWaWV3JyxcbiAgICB2YWxpZEF0dHJpYnV0ZXM6IFJlYWN0TmF0aXZlVmlld0F0dHJpYnV0ZXMuUkNUVmlldyxcbiAgfSxcblxuICAvKipcbiAgICogYFRvdWNoYWJsZS5NaXhpbmAgc2VsZiBjYWxsYmFja3MuIFRoZSBtaXhpbiB3aWxsIGludm9rZSB0aGVzZSBpZiB0aGV5IGFyZVxuICAgKiBkZWZpbmVkIG9uIHlvdXIgY29tcG9uZW50LlxuICAgKi9cbiAgdG91Y2hhYmxlSGFuZGxlQWN0aXZlUHJlc3NJbjogZnVuY3Rpb24oZTogUHJlc3NFdmVudCkge1xuICAgIGNsZWFyVGltZW91dCh0aGlzLl9oaWRlVGltZW91dCk7XG4gICAgdGhpcy5faGlkZVRpbWVvdXQgPSBudWxsO1xuICAgIHRoaXMuX3Nob3dVbmRlcmxheSgpO1xuICAgIHRoaXMucHJvcHMub25QcmVzc0luICYmIHRoaXMucHJvcHMub25QcmVzc0luKGUpO1xuICB9LFxuXG4gIHRvdWNoYWJsZUhhbmRsZUFjdGl2ZVByZXNzT3V0OiBmdW5jdGlvbihlOiBQcmVzc0V2ZW50KSB7XG4gICAgaWYgKCF0aGlzLl9oaWRlVGltZW91dCkge1xuICAgICAgdGhpcy5faGlkZVVuZGVybGF5KCk7XG4gICAgfVxuICAgIHRoaXMucHJvcHMub25QcmVzc091dCAmJiB0aGlzLnByb3BzLm9uUHJlc3NPdXQoZSk7XG4gIH0sXG5cbiAgdG91Y2hhYmxlSGFuZGxlUHJlc3M6IGZ1bmN0aW9uKGU6IFByZXNzRXZlbnQpIHtcbiAgICBjbGVhclRpbWVvdXQodGhpcy5faGlkZVRpbWVvdXQpO1xuICAgIGlmICghUGxhdGZvcm0uaXNUVk9TKSB7XG4gICAgICB0aGlzLl9zaG93VW5kZXJsYXkoKTtcbiAgICAgIHRoaXMuX2hpZGVUaW1lb3V0ID0gc2V0VGltZW91dChcbiAgICAgICAgdGhpcy5faGlkZVVuZGVybGF5LFxuICAgICAgICB0aGlzLnByb3BzLmRlbGF5UHJlc3NPdXQsXG4gICAgICApO1xuICAgIH1cbiAgICB0aGlzLnByb3BzLm9uUHJlc3MgJiYgdGhpcy5wcm9wcy5vblByZXNzKGUpO1xuICB9LFxuXG4gIHRvdWNoYWJsZUhhbmRsZUxvbmdQcmVzczogZnVuY3Rpb24oZTogUHJlc3NFdmVudCkge1xuICAgIHRoaXMucHJvcHMub25Mb25nUHJlc3MgJiYgdGhpcy5wcm9wcy5vbkxvbmdQcmVzcyhlKTtcbiAgfSxcblxuICB0b3VjaGFibGVHZXRQcmVzc1JlY3RPZmZzZXQ6IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB0aGlzLnByb3BzLnByZXNzUmV0ZW50aW9uT2Zmc2V0IHx8IFBSRVNTX1JFVEVOVElPTl9PRkZTRVQ7XG4gIH0sXG5cbiAgdG91Y2hhYmxlR2V0SGl0U2xvcDogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMucHJvcHMuaGl0U2xvcDtcbiAgfSxcblxuICB0b3VjaGFibGVHZXRIaWdobGlnaHREZWxheU1TOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5wcm9wcy5kZWxheVByZXNzSW47XG4gIH0sXG5cbiAgdG91Y2hhYmxlR2V0TG9uZ1ByZXNzRGVsYXlNUzogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIHRoaXMucHJvcHMuZGVsYXlMb25nUHJlc3M7XG4gIH0sXG5cbiAgdG91Y2hhYmxlR2V0UHJlc3NPdXREZWxheU1TOiBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gdGhpcy5wcm9wcy5kZWxheVByZXNzT3V0O1xuICB9LFxuXG4gIF9zaG93VW5kZXJsYXk6IGZ1bmN0aW9uKCkge1xuICAgIGlmICghdGhpcy5faXNNb3VudGVkIHx8ICF0aGlzLl9oYXNQcmVzc0hhbmRsZXIoKSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB0aGlzLnNldFN0YXRlKHtcbiAgICAgIGV4dHJhQ2hpbGRTdHlsZToge1xuICAgICAgICBvcGFjaXR5OiB0aGlzLnByb3BzLmFjdGl2ZU9wYWNpdHksXG4gICAgICB9LFxuICAgICAgZXh0cmFVbmRlcmxheVN0eWxlOiB7XG4gICAgICAgIGJhY2tncm91bmRDb2xvcjogdGhpcy5wcm9wcy51bmRlcmxheUNvbG9yLFxuICAgICAgfSxcbiAgICB9KTtcbiAgICB0aGlzLnByb3BzLm9uU2hvd1VuZGVybGF5ICYmIHRoaXMucHJvcHMub25TaG93VW5kZXJsYXkoKTtcbiAgfSxcblxuICBfaGlkZVVuZGVybGF5OiBmdW5jdGlvbigpIHtcbiAgICBjbGVhclRpbWVvdXQodGhpcy5faGlkZVRpbWVvdXQpO1xuICAgIHRoaXMuX2hpZGVUaW1lb3V0ID0gbnVsbDtcbiAgICBpZiAodGhpcy5wcm9wcy50ZXN0T25seV9wcmVzc2VkKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmICh0aGlzLl9oYXNQcmVzc0hhbmRsZXIoKSkge1xuICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgIGV4dHJhQ2hpbGRTdHlsZTogbnVsbCxcbiAgICAgICAgZXh0cmFVbmRlcmxheVN0eWxlOiBudWxsLFxuICAgICAgfSk7XG4gICAgICB0aGlzLnByb3BzLm9uSGlkZVVuZGVybGF5ICYmIHRoaXMucHJvcHMub25IaWRlVW5kZXJsYXkoKTtcbiAgICB9XG4gIH0sXG5cbiAgX2hhc1ByZXNzSGFuZGxlcjogZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuICEhKFxuICAgICAgdGhpcy5wcm9wcy5vblByZXNzIHx8XG4gICAgICB0aGlzLnByb3BzLm9uUHJlc3NJbiB8fFxuICAgICAgdGhpcy5wcm9wcy5vblByZXNzT3V0IHx8XG4gICAgICB0aGlzLnByb3BzLm9uTG9uZ1ByZXNzXG4gICAgKTtcbiAgfSxcblxuICByZW5kZXI6IGZ1bmN0aW9uKCkge1xuICAgIGNvbnN0IGNoaWxkID0gUmVhY3QuQ2hpbGRyZW4ub25seSh0aGlzLnByb3BzLmNoaWxkcmVuKTtcbiAgICByZXR1cm4gKFxuICAgICAgPFZpZXdcbiAgICAgICAgYWNjZXNzaWJsZT17dGhpcy5wcm9wcy5hY2Nlc3NpYmxlICE9PSBmYWxzZX1cbiAgICAgICAgYWNjZXNzaWJpbGl0eUxhYmVsPXt0aGlzLnByb3BzLmFjY2Vzc2liaWxpdHlMYWJlbH1cbiAgICAgICAgYWNjZXNzaWJpbGl0eUNvbXBvbmVudFR5cGU9e3RoaXMucHJvcHMuYWNjZXNzaWJpbGl0eUNvbXBvbmVudFR5cGV9XG4gICAgICAgIGFjY2Vzc2liaWxpdHlUcmFpdHM9e3RoaXMucHJvcHMuYWNjZXNzaWJpbGl0eVRyYWl0c31cbiAgICAgICAgc3R5bGU9e1N0eWxlU2hlZXQuY29tcG9zZShcbiAgICAgICAgICB0aGlzLnByb3BzLnN0eWxlLFxuICAgICAgICAgIHRoaXMuc3RhdGUuZXh0cmFVbmRlcmxheVN0eWxlLFxuICAgICAgICApfVxuICAgICAgICBvbkxheW91dD17dGhpcy5wcm9wcy5vbkxheW91dH1cbiAgICAgICAgaGl0U2xvcD17dGhpcy5wcm9wcy5oaXRTbG9wfVxuICAgICAgICBpc1RWU2VsZWN0YWJsZT17dHJ1ZX1cbiAgICAgICAgdHZQYXJhbGxheFByb3BlcnRpZXM9e3RoaXMucHJvcHMudHZQYXJhbGxheFByb3BlcnRpZXN9XG4gICAgICAgIGhhc1RWUHJlZmVycmVkRm9jdXM9e3RoaXMucHJvcHMuaGFzVFZQcmVmZXJyZWRGb2N1c31cbiAgICAgICAgb25TdGFydFNob3VsZFNldFJlc3BvbmRlcj17dGhpcy50b3VjaGFibGVIYW5kbGVTdGFydFNob3VsZFNldFJlc3BvbmRlcn1cbiAgICAgICAgb25SZXNwb25kZXJUZXJtaW5hdGlvblJlcXVlc3Q9e1xuICAgICAgICAgIHRoaXMudG91Y2hhYmxlSGFuZGxlUmVzcG9uZGVyVGVybWluYXRpb25SZXF1ZXN0XG4gICAgICAgIH1cbiAgICAgICAgb25SZXNwb25kZXJHcmFudD17dGhpcy50b3VjaGFibGVIYW5kbGVSZXNwb25kZXJHcmFudH1cbiAgICAgICAgb25SZXNwb25kZXJNb3ZlPXt0aGlzLnRvdWNoYWJsZUhhbmRsZVJlc3BvbmRlck1vdmV9XG4gICAgICAgIG9uUmVzcG9uZGVyUmVsZWFzZT17dGhpcy50b3VjaGFibGVIYW5kbGVSZXNwb25kZXJSZWxlYXNlfVxuICAgICAgICBvblJlc3BvbmRlclRlcm1pbmF0ZT17dGhpcy50b3VjaGFibGVIYW5kbGVSZXNwb25kZXJUZXJtaW5hdGV9XG4gICAgICAgIG5hdGl2ZUlEPXt0aGlzLnByb3BzLm5hdGl2ZUlEfVxuICAgICAgICB0ZXN0SUQ9e3RoaXMucHJvcHMudGVzdElEfT5cbiAgICAgICAge1JlYWN0LmNsb25lRWxlbWVudChjaGlsZCwge1xuICAgICAgICAgIHN0eWxlOiBTdHlsZVNoZWV0LmNvbXBvc2UoXG4gICAgICAgICAgICBjaGlsZC5wcm9wcy5zdHlsZSxcbiAgICAgICAgICAgIHRoaXMuc3RhdGUuZXh0cmFDaGlsZFN0eWxlLFxuICAgICAgICAgICksXG4gICAgICAgIH0pfVxuICAgICAgICB7VG91Y2hhYmxlLnJlbmRlckRlYnVnVmlldyh7XG4gICAgICAgICAgY29sb3I6ICdncmVlbicsXG4gICAgICAgICAgaGl0U2xvcDogdGhpcy5wcm9wcy5oaXRTbG9wLFxuICAgICAgICB9KX1cbiAgICAgIDwvVmlldz5cbiAgICApO1xuICB9LFxufSk7XG5cbm1vZHVsZS5leHBvcnRzID0gVG91Y2hhYmxlSGlnaGxpZ2h0O1xuIl19