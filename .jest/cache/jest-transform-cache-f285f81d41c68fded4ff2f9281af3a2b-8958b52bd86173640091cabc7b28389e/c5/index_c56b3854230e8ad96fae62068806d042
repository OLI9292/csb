edf04078dc4df0d267e76afbb42f9ba6
'use strict';require('ts-jest').install("/Users/oliver/Developer/csb/src/Components/Game/Question/index.tsx", "var __extends = (this && this.__extends) || (function () {\n    var extendStatics = Object.setPrototypeOf ||\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport React from 'react';\nimport { Animated } from \"react-native\";\nimport Prompt from './prompt';\nimport Answer from './answer';\nimport Choices from './choices';\nimport _ from \"underscore\";\nvar Question = /** @class */ (function (_super) {\n    __extends(Question, _super);\n    function Question(props) {\n        var _this = _super.call(this, props) || this;\n        _this.state = {\n            isCorrecting: false,\n            layer: 0,\n            userAnswers: [],\n            opacityAnimation: new Animated.Value(1)\n        };\n        _this.promptComponent = React.createRef();\n        _this.choicesComponent = React.createRef();\n        return _this;\n    }\n    Question.prototype.componentDidMount = function () {\n        this.reset(this.props.question);\n    };\n    Question.prototype.componentWillReceiveProps = function (nextProps) {\n        var _this = this;\n        if (nextProps.question && this.props.question !== nextProps.question) {\n            Animated.timing(this.state.opacityAnimation, { toValue: 0, duration: 500 }).start();\n            this.nextQuestionTimeout = setTimeout(function () {\n                _this.reset(nextProps.question);\n                Animated.timing(_this.state.opacityAnimation, { toValue: 1, duration: 500 }).start();\n            }, 500);\n        }\n    };\n    Question.prototype.reset = function (question) {\n        this.setState({\n            question: question,\n            layer: 0,\n            isCorrecting: false,\n            userAnswers: []\n        });\n    };\n    Question.prototype.guessed = function (userAnwer, layer) {\n        var _a = this.state, userAnswers = _a.userAnswers, question = _a.question, isCorrecting = _a.isCorrecting;\n        userAnswers[layer] = userAnwer;\n        this.setState({ userAnswers: userAnswers });\n        layer = layer + 1;\n        isCorrecting = isCorrecting || layer === question.choices.length;\n        if (isCorrecting) {\n            this.setState({ isCorrecting: isCorrecting });\n        }\n        var done = _.every(userAnswers, function (a) { return a.correct; }) &&\n            userAnswers.length === question.choices.length;\n        if (done) {\n            this.props.questionDone();\n        }\n        else {\n            if (isCorrecting) {\n                var incorrectLayer = _.findIndex(userAnswers, function (u) { return !u.correct; });\n                if (incorrectLayer > -1) {\n                    this.setState({ layer: incorrectLayer });\n                }\n            }\n            else {\n                this.setState({ layer: layer });\n            }\n        }\n    };\n    Question.prototype.render = function () {\n        if (!this.state.question) {\n            return null;\n        }\n        var _a = this.state, layer = _a.layer, userAnswers = _a.userAnswers, question = _a.question, isCorrecting = _a.isCorrecting;\n        return (React.createElement(Animated.View, { style: [{ opacity: this.state.opacityAnimation, flex: 8, alignSelf: \"stretch\" }] },\n            React.createElement(Prompt, { ref: this.promptComponent, prompt: question.prompt, secondaryPrompt: question.secondaryPrompt }),\n            React.createElement(Answer, { isCorrecting: isCorrecting, layer: layer, choices: question.choices, userAnswers: userAnswers }),\n            React.createElement(Choices, { isInterlude: this.props.isInterlude, ref: this.choicesComponent, layer: layer, data: question.choices, guessed: this.guessed.bind(this) })));\n    };\n    return Question;\n}(React.Component));\nexport default Question;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJpbmRleC50c3giXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7OztBQUFBLE9BQU8sS0FBSyxNQUFNLE9BQU8sQ0FBQTtBQUV6QixPQUFPLEVBQUUsUUFBUSxFQUFFLE1BQU0sY0FBYyxDQUFBO0FBRXZDLE9BQU8sTUFBTSxNQUFNLFVBQVUsQ0FBQTtBQUM3QixPQUFPLE1BQXNCLE1BQU0sVUFBVSxDQUFBO0FBQzdDLE9BQU8sT0FBTyxNQUFNLFdBQVcsQ0FBQTtBQUMvQixPQUFPLENBQUMsTUFBTSxZQUFZLENBQUE7QUFnQjFCO0lBQXNDLDRCQUE2QjtJQUtqRSxrQkFBWSxLQUFZO1FBQXhCLFlBQ0Usa0JBQU0sS0FBSyxDQUFDLFNBV2I7UUFUQyxLQUFJLENBQUMsS0FBSyxHQUFHO1lBQ1gsWUFBWSxFQUFFLEtBQUs7WUFDbkIsS0FBSyxFQUFFLENBQUM7WUFDUixXQUFXLEVBQUUsRUFBRTtZQUNmLGdCQUFnQixFQUFFLElBQUksUUFBUSxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUM7U0FDeEMsQ0FBQTtRQUVELEtBQUksQ0FBQyxlQUFlLEdBQUcsS0FBSyxDQUFDLFNBQVMsRUFBRSxDQUFBO1FBQ3hDLEtBQUksQ0FBQyxnQkFBZ0IsR0FBRyxLQUFLLENBQUMsU0FBUyxFQUFFLENBQUE7O0lBQzNDLENBQUM7SUFFRCxvQ0FBaUIsR0FBakI7UUFDRSxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLENBQUE7SUFDakMsQ0FBQztJQUVELDRDQUF5QixHQUF6QixVQUEwQixTQUFnQjtRQUExQyxpQkFRQztRQVBDLElBQUksU0FBUyxDQUFDLFFBQVEsSUFBSSxJQUFJLENBQUMsS0FBSyxDQUFDLFFBQVEsS0FBSyxTQUFTLENBQUMsUUFBUSxFQUFFO1lBQ3BFLFFBQVEsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxnQkFBZ0IsRUFB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Q3ZCLGVBQWUsRUFBRSxRQUFRLENBQUMsZUFBZSxHQUFJO1lBRS9DLG9CQUFDLE1BQU0sSUFDTCxZQUFZLEVBQUUsWUFBWSxFQUMxQixLQUFLLEVBQUUsS0FBSyxFQUNaLE9BQU8sRUFBRSxRQUFRLENBQUMsT0FBTyxFQUN6QixXQUFXLEVBQUUsV0FBVyxHQUFJO1lBRTlCLG9CQUFDLE9BQU8sSUFDTixXQUFXLEVBQUUsSUFBSSxDQUFDLEtBQUssQ0FBQyxXQUFXLEVBQ25DLEdBQUcsRUFBRSxJQUFJLENBQUMsZ0JBQWdCLEVBQzFCLEtBQUssRUFBRSxLQUFLLEVBQ1osSUFBSSxFQUFFLFFBQVEsQ0FBQyxPQUFPLEVBQ3RCLE9BQU8sRUFBRSxJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBSSxDQUN4QixDQUNqQixDQUFBO0lBQ0gsQ0FBQztJQUNILGVBQUM7QUFBRCxDQUFDLEFBM0dELENBQXNDLEtBQUssQ0FBQyxTQUFTLEdBMkdwRCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCdcbmltcG9ydCBzdHlsZWQgZnJvbSBcInN0eWxlZC1jb21wb25lbnRzXCJcbmltcG9ydCB7IEFuaW1hdGVkIH0gZnJvbSBcInJlYWN0LW5hdGl2ZVwiXG5cbmltcG9ydCBQcm9tcHQgZnJvbSAnLi9wcm9tcHQnXG5pbXBvcnQgQW5zd2VyLCB7IFVzZXJBbnN3ZXIgfSBmcm9tICcuL2Fuc3dlcidcbmltcG9ydCBDaG9pY2VzIGZyb20gJy4vY2hvaWNlcydcbmltcG9ydCBfIGZyb20gXCJ1bmRlcnNjb3JlXCJcblxuZXhwb3J0IGludGVyZmFjZSBQcm9wcyB7XG4gIHF1ZXN0aW9uOiBhbnksXG4gIHF1ZXN0aW9uRG9uZTogKCkgPT4gdm9pZCxcbiAgaXNJbnRlcmx1ZGU6IGJvb2xlYW5cbn1cblxuaW50ZXJmYWNlIFN0YXRlIHtcbiAgcXVlc3Rpb24/OiBhbnksXG4gIG9wYWNpdHlBbmltYXRpb246IEFuaW1hdGVkLlZhbHVlLFxuICB1c2VyQW5zd2VyczogVXNlckFuc3dlcltdLFxuICBsYXllcjogbnVtYmVyLFxuICBpc0NvcnJlY3Rpbmc6IGJvb2xlYW5cbn1cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUXVlc3Rpb24gZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQ8UHJvcHMsIFN0YXRlPiB7XG4gIHByaXZhdGUgY2hvaWNlc0NvbXBvbmVudDogUmVhY3QuUmVmT2JqZWN0PENob2ljZXM+XG4gIHByaXZhdGUgcHJvbXB0Q29tcG9uZW50OiBSZWFjdC5SZWZPYmplY3Q8UHJvbXB0PlxuICBwcml2YXRlIG5leHRRdWVzdGlvblRpbWVvdXQ6IGFueVxuXG4gIGNvbnN0cnVjdG9yKHByb3BzOiBQcm9wcykge1xuICAgIHN1cGVyKHByb3BzKVxuXG4gICAgdGhpcy5zdGF0ZSA9IHtcbiAgICAgIGlzQ29ycmVjdGluZzogZmFsc2UsXG4gICAgICBsYXllcjogMCxcbiAgICAgIHVzZXJBbnN3ZXJzOiBbXSxcbiAgICAgIG9wYWNpdHlBbmltYXRpb246IG5ldyBBbmltYXRlZC5WYWx1ZSgxKVxuICAgIH1cblxuICAgIHRoaXMucHJvbXB0Q29tcG9uZW50ID0gUmVhY3QuY3JlYXRlUmVmKClcbiAgICB0aGlzLmNob2ljZXNDb21wb25lbnQgPSBSZWFjdC5jcmVhdGVSZWYoKVxuICB9XG5cbiAgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgdGhpcy5yZXNldCh0aGlzLnByb3BzLnF1ZXN0aW9uKVxuICB9XG5cbiAgY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyhuZXh0UHJvcHM6IFByb3BzKSB7XG4gICAgaWYgKG5leHRQcm9wcy5xdWVzdGlvbiAmJiB0aGlzLnByb3BzLnF1ZXN0aW9uICE9PSBuZXh0UHJvcHMucXVlc3Rpb24pIHtcbiAgICAgIEFuaW1hdGVkLnRpbWluZyh0aGlzLnN0YXRlLm9wYWNpdHlBbmltYXRpb24sIHsgdG9WYWx1ZTogMCwgZHVyYXRpb246IDUwMCB9KS5zdGFydCgpXG4gICAgICB0aGlzLm5leHRRdWVzdGlvblRpbWVvdXQgPSBzZXRUaW1lb3V0KCgpID0+IHsgIFxuICAgICAgICB0aGlzLnJlc2V0KG5leHRQcm9wcy5xdWVzdGlvbilcbiAgICAgICAgQW5pbWF0ZWQudGltaW5nKHRoaXMuc3RhdGUub3BhY2l0eUFuaW1hdGlvbiwgeyB0b1ZhbHVlOiAxLCBkdXJhdGlvbjogNTAwIH0pLnN0YXJ0KClcbiAgICAgIH0sIDUwMClcbiAgICB9XG4gIH1cblxuICByZXNldChxdWVzdGlvbjogYW55KSB7XG4gICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICBxdWVzdGlvbjogcXVlc3Rpb24sXG4gICAgICBsYXllcjogMCxcbiAgICAgIGlzQ29ycmVjdGluZzogZmFsc2UsXG4gICAgICB1c2VyQW5zd2VyczogW11cbiAgICB9KVxuICB9XG5cbiAgXG5cbiAgZ3Vlc3NlZCh1c2VyQW53ZXI6IFVzZXJBbnN3ZXIsIGxheWVyOiBudW1iZXIpIHsgIFxuICAgIGxldCB7XG4gICAgICB1c2VyQW5zd2VycyxcbiAgICAgIHF1ZXN0aW9uLFxuICAgICAgaXNDb3JyZWN0aW5nXG4gICAgfSA9IHRoaXMuc3RhdGVcblxuICAgIHVzZXJBbnN3ZXJzW2xheWVyXSA9IHVzZXJBbndlclxuICAgIHRoaXMuc2V0U3RhdGUoeyB1c2VyQW5zd2VycyB9KVxuICAgIGxheWVyID0gbGF5ZXIgKyAxXG4gICAgXG4gICAgaXNDb3JyZWN0aW5nID0gaXNDb3JyZWN0aW5nIHx8ICBsYXllciA9PT0gcXVlc3Rpb24uY2hvaWNlcy5sZW5ndGhcbiAgICBpZiAoaXNDb3JyZWN0aW5nKSB7IHRoaXMuc2V0U3RhdGUoeyBpc0NvcnJlY3RpbmcgfSkgfVxuXG4gICAgY29uc3QgZG9uZSA9IF8uZXZlcnkodXNlckFuc3dlcnMsIGEgPT4gYS5jb3JyZWN0KSAmJlxuICAgICAgdXNlckFuc3dlcnMubGVuZ3RoID09PSBxdWVzdGlvbi5jaG9pY2VzLmxlbmd0aFxuXG4gICAgaWYgKGRvbmUpIHtcbiAgICAgIHRoaXMucHJvcHMucXVlc3Rpb25Eb25lKClcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKGlzQ29ycmVjdGluZykge1xuICAgICAgICBjb25zdCBpbmNvcnJlY3RMYXllciA9IF8uZmluZEluZGV4KHVzZXJBbnN3ZXJzLCB1ID0+ICF1LmNvcnJlY3QpXG4gICAgICAgIGlmIChpbmNvcnJlY3RMYXllciA+IC0xKSB7IHRoaXMuc2V0U3RhdGUoeyBsYXllcjogaW5jb3JyZWN0TGF5ZXIgfSkgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5zZXRTdGF0ZSh7IGxheWVyIH0pXG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcmVuZGVyKCkge1xuICAgIGlmICghdGhpcy5zdGF0ZS5xdWVzdGlvbikgeyBcbiAgICAgIHJldHVybiBudWxsXG4gICAgfVxuICAgIFxuICAgIGNvbnN0IHtcbiAgICAgIGxheWVyLFxuICAgICAgdXNlckFuc3dlcnMsXG4gICAgICBxdWVzdGlvbixcbiAgICAgIGlzQ29ycmVjdGluZ1xuICAgIH0gPSB0aGlzLnN0YXRlXG5cbiAgICByZXR1cm4gKFxuICAgICAgPEFuaW1hdGVkLlZpZXcgc3R5bGU9e1t7IG9wYWNpdHk6IHRoaXMuc3RhdGUub3BhY2l0eUFuaW1hdGlvbiwgZmxleDogOCwgYWxpZ25TZWxmOiBcInN0cmV0Y2hcIiB9XX0+XG4gICAgICAgIDxQcm9tcHRcbiAgICAgICAgICByZWY9e3RoaXMucHJvbXB0Q29tcG9uZW50fVxuICAgICAgICAgIHByb21wdD17cXVlc3Rpb24ucHJvbXB0fVxuICAgICAgICAgIHNlY29uZGFyeVByb21wdD17cXVlc3Rpb24uc2Vjb25kYXJ5UHJvbXB0fSAvPlxuXG4gICAgICAgIDxBbnN3ZXJcbiAgICAgICAgICBpc0NvcnJlY3Rpbmc9e2lzQ29ycmVjdGluZ31cbiAgICAgICAgICBsYXllcj17bGF5ZXJ9XG4gICAgICAgICAgY2hvaWNlcz17cXVlc3Rpb24uY2hvaWNlc31cbiAgICAgICAgICB1c2VyQW5zd2Vycz17dXNlckFuc3dlcnN9IC8+ICAgICAgICAgIFxuXG4gICAgICAgIDxDaG9pY2VzXG4gICAgICAgICAgaXNJbnRlcmx1ZGU9e3RoaXMucHJvcHMuaXNJbnRlcmx1ZGV9XG4gICAgICAgICAgcmVmPXt0aGlzLmNob2ljZXNDb21wb25lbnR9XG4gICAgICAgICAgbGF5ZXI9e2xheWVyfVxuICAgICAgICAgIGRhdGE9e3F1ZXN0aW9uLmNob2ljZXN9XG4gICAgICAgICAgZ3Vlc3NlZD17dGhpcy5ndWVzc2VkLmJpbmQodGhpcyl9IC8+XG4gICAgICA8L0FuaW1hdGVkLlZpZXc+XG4gICAgKVxuICB9XG59XG4iXX0=");'use strict';Object.defineProperty(exports, "__esModule", { value: true });









var _react = require('react');var _react2 = _interopRequireDefault(_react);
var _reactNative = require('react-native');
var _prompt = require('./prompt');var _prompt2 = _interopRequireDefault(_prompt);
var _answer = require('./answer');var _answer2 = _interopRequireDefault(_answer);
var _choices = require('./choices');var _choices2 = _interopRequireDefault(_choices);
var _underscore = require('underscore');var _underscore2 = _interopRequireDefault(_underscore);function _interopRequireDefault(obj) {return obj && obj.__esModule ? obj : { default: obj };}var __extends = undefined && undefined.__extends || function () {var extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (d, b) {d.__proto__ = b;} || function (d, b) {for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];};return function (d, b) {extendStatics(d, b);function __() {this.constructor = d;}d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());};}();
var Question = /** @class */function (_super) {
    __extends(Question, _super);
    function Question(props) {
        var _this = _super.call(this, props) || this;
        _this.state = {
            isCorrecting: false,
            layer: 0,
            userAnswers: [],
            opacityAnimation: new _reactNative.Animated.Value(1) };

        _this.promptComponent = _react2.default.createRef();
        _this.choicesComponent = _react2.default.createRef();
        return _this;
    }
    Question.prototype.componentDidMount = function () {
        this.reset(this.props.question);
    };
    Question.prototype.componentWillReceiveProps = function (nextProps) {
        var _this = this;
        if (nextProps.question && this.props.question !== nextProps.question) {
            _reactNative.Animated.timing(this.state.opacityAnimation, { toValue: 0, duration: 500 }).start();
            this.nextQuestionTimeout = setTimeout(function () {
                _this.reset(nextProps.question);
                _reactNative.Animated.timing(_this.state.opacityAnimation, { toValue: 1, duration: 500 }).start();
            }, 500);
        }
    };
    Question.prototype.reset = function (question) {
        this.setState({
            question: question,
            layer: 0,
            isCorrecting: false,
            userAnswers: [] });

    };
    Question.prototype.guessed = function (userAnwer, layer) {
        var _a = this.state,userAnswers = _a.userAnswers,question = _a.question,isCorrecting = _a.isCorrecting;
        userAnswers[layer] = userAnwer;
        this.setState({ userAnswers: userAnswers });
        layer = layer + 1;
        isCorrecting = isCorrecting || layer === question.choices.length;
        if (isCorrecting) {
            this.setState({ isCorrecting: isCorrecting });
        }
        var done = _underscore2.default.every(userAnswers, function (a) {return a.correct;}) &&
        userAnswers.length === question.choices.length;
        if (done) {
            this.props.questionDone();
        } else
        {
            if (isCorrecting) {
                var incorrectLayer = _underscore2.default.findIndex(userAnswers, function (u) {return !u.correct;});
                if (incorrectLayer > -1) {
                    this.setState({ layer: incorrectLayer });
                }
            } else
            {
                this.setState({ layer: layer });
            }
        }
    };
    Question.prototype.render = function () {
        if (!this.state.question) {
            return null;
        }
        var _a = this.state,layer = _a.layer,userAnswers = _a.userAnswers,question = _a.question,isCorrecting = _a.isCorrecting;
        return _react2.default.createElement(_reactNative.Animated.View, { style: [{ opacity: this.state.opacityAnimation, flex: 8, alignSelf: "stretch" }] },
        _react2.default.createElement(_prompt2.default, { ref: this.promptComponent, prompt: question.prompt, secondaryPrompt: question.secondaryPrompt }),
        _react2.default.createElement(_answer2.default, { isCorrecting: isCorrecting, layer: layer, choices: question.choices, userAnswers: userAnswers }),
        _react2.default.createElement(_choices2.default, { isInterlude: this.props.isInterlude, ref: this.choicesComponent, layer: layer, data: question.choices, guessed: this.guessed.bind(this) }));
    };
    return Question;
}(_react2.default.Component);exports.default =
Question;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LENBWkYsQ0FERjtBQXFCRCxLQWpDRDtBQWtDRixXQUFBLFFBQUE7QUFBQyxDQTNHRCxDQUFzQyxnQkFBTSxTQUE1QyxDQUFBLEMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QgZnJvbSAncmVhY3QnXG5pbXBvcnQgc3R5bGVkIGZyb20gXCJzdHlsZWQtY29tcG9uZW50c1wiXG5pbXBvcnQgeyBBbmltYXRlZCB9IGZyb20gXCJyZWFjdC1uYXRpdmVcIlxuXG5pbXBvcnQgUHJvbXB0IGZyb20gJy4vcHJvbXB0J1xuaW1wb3J0IEFuc3dlciwgeyBVc2VyQW5zd2VyIH0gZnJvbSAnLi9hbnN3ZXInXG5pbXBvcnQgQ2hvaWNlcyBmcm9tICcuL2Nob2ljZXMnXG5pbXBvcnQgXyBmcm9tIFwidW5kZXJzY29yZVwiXG5cbmV4cG9ydCBpbnRlcmZhY2UgUHJvcHMge1xuICBxdWVzdGlvbjogYW55LFxuICBxdWVzdGlvbkRvbmU6ICgpID0+IHZvaWQsXG4gIGlzSW50ZXJsdWRlOiBib29sZWFuXG59XG5cbmludGVyZmFjZSBTdGF0ZSB7XG4gIHF1ZXN0aW9uPzogYW55LFxuICBvcGFjaXR5QW5pbWF0aW9uOiBBbmltYXRlZC5WYWx1ZSxcbiAgdXNlckFuc3dlcnM6IFVzZXJBbnN3ZXJbXSxcbiAgbGF5ZXI6IG51bWJlcixcbiAgaXNDb3JyZWN0aW5nOiBib29sZWFuXG59XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFF1ZXN0aW9uIGV4dGVuZHMgUmVhY3QuQ29tcG9uZW50PFByb3BzLCBTdGF0ZT4ge1xuICBwcml2YXRlIGNob2ljZXNDb21wb25lbnQ6IFJlYWN0LlJlZk9iamVjdDxDaG9pY2VzPlxuICBwcml2YXRlIHByb21wdENvbXBvbmVudDogUmVhY3QuUmVmT2JqZWN0PFByb21wdD5cbiAgcHJpdmF0ZSBuZXh0UXVlc3Rpb25UaW1lb3V0OiBhbnlcblxuICBjb25zdHJ1Y3Rvcihwcm9wczogUHJvcHMpIHtcbiAgICBzdXBlcihwcm9wcylcblxuICAgIHRoaXMuc3RhdGUgPSB7XG4gICAgICBpc0NvcnJlY3Rpbmc6IGZhbHNlLFxuICAgICAgbGF5ZXI6IDAsXG4gICAgICB1c2VyQW5zd2VyczogW10sXG4gICAgICBvcGFjaXR5QW5pbWF0aW9uOiBuZXcgQW5pbWF0ZWQuVmFsdWUoMSlcbiAgICB9XG5cbiAgICB0aGlzLnByb21wdENvbXBvbmVudCA9IFJlYWN0LmNyZWF0ZVJlZigpXG4gICAgdGhpcy5jaG9pY2VzQ29tcG9uZW50ID0gUmVhY3QuY3JlYXRlUmVmKClcbiAgfVxuXG4gIGNvbXBvbmVudERpZE1vdW50KCkge1xuICAgIHRoaXMucmVzZXQodGhpcy5wcm9wcy5xdWVzdGlvbilcbiAgfVxuXG4gIGNvbXBvbmVudFdpbGxSZWNlaXZlUHJvcHMobmV4dFByb3BzOiBQcm9wcykge1xuICAgIGlmIChuZXh0UHJvcHMucXVlc3Rpb24gJiYgdGhpcy5wcm9wcy5xdWVzdGlvbiAhPT0gbmV4dFByb3BzLnF1ZXN0aW9uKSB7XG4gICAgICBBbmltYXRlZC50aW1pbmcodGhpcy5zdGF0ZS5vcGFjaXR5QW5pbWF0aW9uLCB7IHRvVmFsdWU6IDAsIGR1cmF0aW9uOiA1MDAgfSkuc3RhcnQoKVxuICAgICAgdGhpcy5uZXh0UXVlc3Rpb25UaW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiB7ICBcbiAgICAgICAgdGhpcy5yZXNldChuZXh0UHJvcHMucXVlc3Rpb24pXG4gICAgICAgIEFuaW1hdGVkLnRpbWluZyh0aGlzLnN0YXRlLm9wYWNpdHlBbmltYXRpb24sIHsgdG9WYWx1ZTogMSwgZHVyYXRpb246IDUwMCB9KS5zdGFydCgpXG4gICAgICB9LCA1MDApXG4gICAgfVxuICB9XG5cbiAgcmVzZXQocXVlc3Rpb246IGFueSkge1xuICAgIHRoaXMuc2V0U3RhdGUoe1xuICAgICAgcXVlc3Rpb246IHF1ZXN0aW9uLFxuICAgICAgbGF5ZXI6IDAsXG4gICAgICBpc0NvcnJlY3Rpbmc6IGZhbHNlLFxuICAgICAgdXNlckFuc3dlcnM6IFtdXG4gICAgfSlcbiAgfVxuXG4gIFxuXG4gIGd1ZXNzZWQodXNlckFud2VyOiBVc2VyQW5zd2VyLCBsYXllcjogbnVtYmVyKSB7ICBcbiAgICBsZXQge1xuICAgICAgdXNlckFuc3dlcnMsXG4gICAgICBxdWVzdGlvbixcbiAgICAgIGlzQ29ycmVjdGluZ1xuICAgIH0gPSB0aGlzLnN0YXRlXG5cbiAgICB1c2VyQW5zd2Vyc1tsYXllcl0gPSB1c2VyQW53ZXJcbiAgICB0aGlzLnNldFN0YXRlKHsgdXNlckFuc3dlcnMgfSlcbiAgICBsYXllciA9IGxheWVyICsgMVxuICAgIFxuICAgIGlzQ29ycmVjdGluZyA9IGlzQ29ycmVjdGluZyB8fCAgbGF5ZXIgPT09IHF1ZXN0aW9uLmNob2ljZXMubGVuZ3RoXG4gICAgaWYgKGlzQ29ycmVjdGluZykgeyB0aGlzLnNldFN0YXRlKHsgaXNDb3JyZWN0aW5nIH0pIH1cblxuICAgIGNvbnN0IGRvbmUgPSBfLmV2ZXJ5KHVzZXJBbnN3ZXJzLCBhID0+IGEuY29ycmVjdCkgJiZcbiAgICAgIHVzZXJBbnN3ZXJzLmxlbmd0aCA9PT0gcXVlc3Rpb24uY2hvaWNlcy5sZW5ndGhcblxuICAgIGlmIChkb25lKSB7XG4gICAgICB0aGlzLnByb3BzLnF1ZXN0aW9uRG9uZSgpXG4gICAgfSBlbHNlIHtcbiAgICAgIGlmIChpc0NvcnJlY3RpbmcpIHtcbiAgICAgICAgY29uc3QgaW5jb3JyZWN0TGF5ZXIgPSBfLmZpbmRJbmRleCh1c2VyQW5zd2VycywgdSA9PiAhdS5jb3JyZWN0KVxuICAgICAgICBpZiAoaW5jb3JyZWN0TGF5ZXIgPiAtMSkgeyB0aGlzLnNldFN0YXRlKHsgbGF5ZXI6IGluY29ycmVjdExheWVyIH0pIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMuc2V0U3RhdGUoeyBsYXllciB9KVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICBpZiAoIXRoaXMuc3RhdGUucXVlc3Rpb24pIHsgXG4gICAgICByZXR1cm4gbnVsbFxuICAgIH1cbiAgICBcbiAgICBjb25zdCB7XG4gICAgICBsYXllcixcbiAgICAgIHVzZXJBbnN3ZXJzLFxuICAgICAgcXVlc3Rpb24sXG4gICAgICBpc0NvcnJlY3RpbmdcbiAgICB9ID0gdGhpcy5zdGF0ZVxuXG4gICAgcmV0dXJuIChcbiAgICAgIDxBbmltYXRlZC5WaWV3IHN0eWxlPXtbeyBvcGFjaXR5OiB0aGlzLnN0YXRlLm9wYWNpdHlBbmltYXRpb24sIGZsZXg6IDgsIGFsaWduU2VsZjogXCJzdHJldGNoXCIgfV19PlxuICAgICAgICA8UHJvbXB0XG4gICAgICAgICAgcmVmPXt0aGlzLnByb21wdENvbXBvbmVudH1cbiAgICAgICAgICBwcm9tcHQ9e3F1ZXN0aW9uLnByb21wdH1cbiAgICAgICAgICBzZWNvbmRhcnlQcm9tcHQ9e3F1ZXN0aW9uLnNlY29uZGFyeVByb21wdH0gLz5cblxuICAgICAgICA8QW5zd2VyXG4gICAgICAgICAgaXNDb3JyZWN0aW5nPXtpc0NvcnJlY3Rpbmd9XG4gICAgICAgICAgbGF5ZXI9e2xheWVyfVxuICAgICAgICAgIGNob2ljZXM9e3F1ZXN0aW9uLmNob2ljZXN9XG4gICAgICAgICAgdXNlckFuc3dlcnM9e3VzZXJBbnN3ZXJzfSAvPiAgICAgICAgICBcblxuICAgICAgICA8Q2hvaWNlc1xuICAgICAgICAgIGlzSW50ZXJsdWRlPXt0aGlzLnByb3BzLmlzSW50ZXJsdWRlfVxuICAgICAgICAgIHJlZj17dGhpcy5jaG9pY2VzQ29tcG9uZW50fVxuICAgICAgICAgIGxheWVyPXtsYXllcn1cbiAgICAgICAgICBkYXRhPXtxdWVzdGlvbi5jaG9pY2VzfVxuICAgICAgICAgIGd1ZXNzZWQ9e3RoaXMuZ3Vlc3NlZC5iaW5kKHRoaXMpfSAvPlxuICAgICAgPC9BbmltYXRlZC5WaWV3PlxuICAgIClcbiAgfVxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==